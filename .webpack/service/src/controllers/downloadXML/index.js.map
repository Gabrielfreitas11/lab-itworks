{"version":3,"file":"src/controllers/downloadXML/index.js","mappings":"qBAocAA,EAAOC,QAAU,CAAEC,MApcL,CACZ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,KACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,GAAI,IACJ,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KAqOmBC,aAlOL,CACnB,IAAK,GACL,IAAK,GACL,IAAK,GACLC,EAAG,GACH,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACLC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,GACH,IAAK,GACL,KAAM,GACN,IAAK,GACL,IAAK,GACLC,EAAG,GACH,IAAK,GACLC,EAAG,GACHC,EAAG,GACHC,EAAG,GACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACH,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACLC,EAAG,IACH,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACLC,EAAG,IACH,IAAK,IACLC,EAAG,IACH,IAAK,IACLC,EAAG,IACH,IAAK,IACLC,EAAG,IACH,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACLC,EAAG,IACH,IAAK,IACLC,EAAG,IACH,IAAK,IACLC,EAAG,IA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","sources":["webpack://node/./common/cryptography/data.js","webpack://node/./common/cryptography/index.js","webpack://node/webpack/bootstrap","webpack://node/webpack/runtime/compat get default export","webpack://node/webpack/runtime/define property getters","webpack://node/webpack/runtime/hasOwnProperty shorthand","webpack://node/webpack/runtime/make namespace object","webpack://node/external commonjs \"@babel/runtime/helpers/asyncToGenerator\"","webpack://node/./common/httpResponse.js","webpack://node/external commonjs \"@hapi/joi\"","webpack://node/./src/controllers/downloadXML/validations/schema.js","webpack://node/external commonjs \"@babel/runtime/helpers/defineProperty\"","webpack://node/./common/handler/BaseController.js","webpack://node/./common/handler/handle.js","webpack://node/external commonjs \"axios\"","webpack://node/external commonjs \"@babel/runtime/helpers/taggedTemplateLiteral\"","webpack://node/external commonjs \"mssql\"","webpack://node/./common/mssql.js","webpack://node/external commonjs \"tough-cookie\"","webpack://node/external commonjs \"http-cookie-agent/http\"","webpack://node/./src/controllers/downloadXML/functions/getCert.js","webpack://node/./src/controllers/downloadXML/functions/download.js","webpack://node/external commonjs \"form-data\"","webpack://node/./src/controllers/downloadXML/functions/sendFileToPath.js","webpack://node/./src/controllers/downloadXML/index.js","webpack://node/./src/controllers/downloadXML/validations/validator.js"],"sourcesContent":["const codes = {\n  33: '!',\n  34: '\"',\n  35: '#',\n  36: '$',\n  37: '%',\n  38: '&',\n  39: \"'\",\n  40: '(',\n  41: ')',\n  42: '*',\n  43: '+',\n  44: ',',\n  45: '-',\n  46: '.',\n  47: '/',\n  48: '0',\n  49: '1',\n  50: '2',\n  51: '3',\n  52: '4',\n  53: '5',\n  54: '6',\n  55: '7',\n  56: '8',\n  57: '9',\n  58: ':',\n  59: ';',\n  60: '<',\n  61: '=',\n  62: '>',\n  63: '?',\n  64: '@',\n  65: 'A',\n  66: 'B',\n  67: 'C',\n  68: 'D',\n  69: 'E',\n  70: 'F',\n  71: 'G',\n  72: 'H',\n  73: 'I',\n  74: 'J',\n  75: 'K',\n  76: 'L',\n  77: 'M',\n  78: 'N',\n  79: 'O',\n  80: 'P',\n  81: 'Q',\n  82: 'R',\n  83: 'S',\n  84: 'T',\n  85: 'U',\n  86: 'V',\n  87: 'W',\n  88: 'X',\n  89: 'Y',\n  90: 'Z',\n  91: '[',\n  92: '\\\\',\n  93: ']',\n  94: '^',\n  95: '_',\n  96: '`',\n  97: 'a',\n  98: 'b',\n  99: 'c',\n  100: 'd',\n  101: 'e',\n  102: 'f',\n  103: 'g',\n  104: 'h',\n  105: 'i',\n  106: 'j',\n  107: 'k',\n  108: 'l',\n  109: 'm',\n  110: 'n',\n  111: 'o',\n  112: 'p',\n  113: 'q',\n  114: 'r',\n  115: 's',\n  116: 't',\n  117: 'u',\n  118: 'v',\n  119: 'w',\n  120: 'x',\n  121: 'y',\n  122: 'z',\n  123: '{',\n  124: '|',\n  125: '}',\n  126: '~',\n  127: ' ',\n  128: '€',\n  129: ' ',\n  130: '‚',\n  131: 'ƒ',\n  132: '„',\n  133: '…',\n  134: '†',\n  135: '‡',\n  136: 'ˆ',\n  137: '‰',\n  138: 'Š',\n  139: '‹',\n  140: 'Œ',\n  141: ' ',\n  142: 'Ž',\n  143: ' ',\n  144: ' ',\n  145: '‘',\n  146: '’',\n  147: '“',\n  148: '”',\n  149: '•',\n  150: '–',\n  151: '—',\n  152: '˜',\n  153: '™',\n  154: 'š',\n  155: '›',\n  156: 'œ',\n  157: ' ',\n  158: 'ž',\n  159: 'Ÿ',\n  160: ' ',\n  161: '¡',\n  162: '¢',\n  163: '£',\n  164: '¤',\n  165: '¥',\n  166: '¦',\n  167: '§',\n  168: '¨',\n  169: '©',\n  170: 'ª',\n  171: '«',\n  172: '¬',\n  173: '�­',\n  174: '®',\n  175: '¯',\n  176: '°',\n  177: '±',\n  178: '²',\n  179: '³',\n  180: '´',\n  181: 'µ',\n  182: '¶',\n  183: '·',\n  184: '¸',\n  185: '¹',\n  186: 'º',\n  187: '»',\n  188: '¼',\n  189: '½',\n  190: '¾',\n  191: '¿',\n  192: 'À',\n  193: 'Á',\n  194: 'Â',\n  195: 'Ã',\n  196: 'Ä',\n  197: 'Å',\n  198: 'Æ',\n  199: 'Ç',\n  200: 'È',\n  201: 'É',\n  202: 'Ê',\n  203: 'Ë',\n  204: 'Ì',\n  205: 'Í',\n  206: 'Î',\n  207: 'Ï',\n  208: 'Ð',\n  209: 'Ñ',\n  210: 'Ò',\n  211: 'Ó',\n  212: 'Ô',\n  213: 'Õ',\n  214: 'Ö',\n  215: '×',\n  216: 'Ø',\n  217: 'Ù',\n  218: 'Ú',\n  219: 'Û',\n  220: 'Ü',\n  221: 'Ý',\n  222: 'Þ',\n  223: 'ß',\n  224: 'à',\n  225: 'á',\n  226: 'â',\n  227: 'ã',\n  228: 'ä',\n  229: 'å',\n  230: 'æ',\n  231: 'ç',\n  232: 'è',\n  233: 'é',\n  234: 'ê',\n  235: 'ë',\n  236: 'ì',\n  237: 'í',\n  238: 'î',\n  239: 'ï',\n  240: 'ð',\n  241: 'ñ',\n  242: 'ò',\n  243: 'ó',\n  244: 'ô',\n  245: 'õ',\n  246: 'ö',\n  247: '÷',\n  248: 'ø',\n  249: 'ù',\n  250: 'ú',\n  251: 'û',\n  252: 'ü',\n  253: 'ý',\n  254: 'þ',\n  255: 'ÿ',\n}\n\nconst reverseCodes = {\n  '!': 33,\n  '\"': 34,\n  '#': 35,\n  $: 36,\n  '%': 37,\n  '&': 38,\n  \"'\": 39,\n  '(': 40,\n  ')': 41,\n  '*': 42,\n  '+': 43,\n  ',': 44,\n  '-': 45,\n  '.': 46,\n  '/': 47,\n  0: 48,\n  1: 49,\n  2: 50,\n  3: 51,\n  4: 52,\n  5: 53,\n  6: 54,\n  7: 55,\n  8: 56,\n  9: 57,\n  ':': 58,\n  ';': 59,\n  '<': 60,\n  '=': 61,\n  '>': 62,\n  '?': 63,\n  '@': 64,\n  A: 65,\n  B: 66,\n  C: 67,\n  D: 68,\n  E: 69,\n  F: 70,\n  G: 71,\n  H: 72,\n  I: 73,\n  J: 74,\n  K: 75,\n  L: 76,\n  M: 77,\n  N: 78,\n  O: 79,\n  P: 80,\n  Q: 81,\n  R: 82,\n  S: 83,\n  T: 84,\n  U: 85,\n  V: 86,\n  W: 87,\n  X: 88,\n  Y: 89,\n  Z: 90,\n  '[': 91,\n  '\\\\': 92,\n  ']': 93,\n  '^': 94,\n  _: 95,\n  '`': 96,\n  a: 97,\n  b: 98,\n  c: 99,\n  d: 100,\n  e: 101,\n  f: 102,\n  g: 103,\n  h: 104,\n  i: 105,\n  j: 106,\n  k: 107,\n  l: 108,\n  m: 109,\n  n: 110,\n  o: 111,\n  p: 112,\n  q: 113,\n  r: 114,\n  s: 115,\n  t: 116,\n  u: 117,\n  v: 118,\n  w: 119,\n  x: 120,\n  y: 121,\n  z: 122,\n  '{': 123,\n  '|': 124,\n  '}': 125,\n  '~': 126,\n  ' ': 127,\n  '€': 128,\n  ' ': 129,\n  '‚': 130,\n  ƒ: 131,\n  '„': 132,\n  '…': 133,\n  '†': 134,\n  '‡': 135,\n  ˆ: 136,\n  '‰': 137,\n  Š: 138,\n  '‹': 139,\n  Œ: 140,\n  ' ': 141,\n  Ž: 142,\n  ' ': 143,\n  ' ': 144,\n  '‘': 145,\n  '’': 146,\n  '“': 147,\n  '”': 148,\n  '•': 149,\n  '–': 150,\n  '—': 151,\n  '˜': 152,\n  '™': 153,\n  š: 154,\n  '›': 155,\n  œ: 156,\n  ' ': 157,\n  ž: 158,\n  Ÿ: 159,\n  ' ': 160,\n  '¡': 161,\n  '¢': 162,\n  '£': 163,\n  '¤': 164,\n  '¥': 165,\n  '¦': 166,\n  '§': 167,\n  '¨': 168,\n  '©': 169,\n  ª: 170,\n  '«': 171,\n  '¬': 172,\n  '�­': 173,\n  '®': 174,\n  '¯': 175,\n  '°': 176,\n  '±': 177,\n  '²': 178,\n  '³': 179,\n  '´': 180,\n  µ: 181,\n  '¶': 182,\n  '·': 183,\n  '¸': 184,\n  '¹': 185,\n  º: 186,\n  '»': 187,\n  '¼': 188,\n  '½': 189,\n  '¾': 190,\n  '¿': 191,\n  À: 192,\n  Á: 193,\n  Â: 194,\n  Ã: 195,\n  Ä: 196,\n  Å: 197,\n  Æ: 198,\n  Ç: 199,\n  È: 200,\n  É: 201,\n  Ê: 202,\n  Ë: 203,\n  Ì: 204,\n  Í: 205,\n  Î: 206,\n  Ï: 207,\n  Ð: 208,\n  Ñ: 209,\n  Ò: 210,\n  Ó: 211,\n  Ô: 212,\n  Õ: 213,\n  Ö: 214,\n  '×': 215,\n  Ø: 216,\n  Ù: 217,\n  Ú: 218,\n  Û: 219,\n  Ü: 220,\n  Ý: 221,\n  Þ: 222,\n  ß: 223,\n  à: 224,\n  á: 225,\n  â: 226,\n  ã: 227,\n  ä: 228,\n  å: 229,\n  æ: 230,\n  ç: 231,\n  è: 232,\n  é: 233,\n  ê: 234,\n  ë: 235,\n  ì: 236,\n  í: 237,\n  î: 238,\n  ï: 239,\n  ð: 240,\n  ñ: 241,\n  ò: 242,\n  ó: 243,\n  ô: 244,\n  õ: 245,\n  ö: 246,\n  '÷': 247,\n  ø: 248,\n  ù: 249,\n  ú: 250,\n  û: 251,\n  ü: 252,\n  ý: 253,\n  þ: 254,\n  ÿ: 255,\n}\n\nmodule.exports = { codes, reverseCodes }\n","const { codes, reverseCodes } = require(\"./data\");\n\nconst criptoRule = (strCripto, cypher = true) => {\n  let valorFinal = \"\";\n\n  const aChaves = [77, 84, 79, 65, 73, 78, 67, 70, 82];\n\n  const arrayCaracteres = strCripto.split(\"\");\n\n  arrayCaracteres.forEach((el, i) => {\n    let n = reverseCodes[el];\n\n    if (n > 31) {\n      n = n - 32;\n\n      const valor = cypher ? 1 : -1;\n\n      n = n + aChaves[i % 9] * valor;\n\n      n = n % 224;\n\n      if (n < 0) {\n        n = 224 + n;\n      }\n\n      n = n + 32;\n    }\n\n    valorFinal = valorFinal + codes[n];\n  });\n\n  return valorFinal;\n};\n\nmodule.exports = {\n  encrypt: (strCripto) => criptoRule(strCripto),\n\n  decrypt: (strCripto) => criptoRule(strCripto, false),\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/asyncToGenerator\");","export default class HttpResponse {\r\n  static ok(body) {\r\n    return {\r\n      statusCode: 200,\r\n      body,\r\n    };\r\n  }\r\n\r\n  static created(body) {\r\n    return {\r\n      statusCode: 201,\r\n      body,\r\n    };\r\n  }\r\n\r\n  static notFound(body) {\r\n    return {\r\n      statusCode: 404,\r\n      body,\r\n    };\r\n  }\r\n\r\n  static badRequest(body) {\r\n    return {\r\n      statusCode: 400,\r\n      body,\r\n    };\r\n  }\r\n\r\n  static serverError(body) {\r\n    return {\r\n      statusCode: 500,\r\n      body,\r\n    };\r\n  }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@hapi/joi\");","import Joi from '@hapi/joi';\n\nexport const schema = Joi.object({\n  url: Joi.string().required(),\n  key: Joi.string().required(),\n  cnpj: Joi.string().required(),\n});\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/defineProperty\");","export default class BaseController {\n  event = null;\n\n  context = null;\n\n  env = process.env;\n\n  async handle(event, context, method, isHttpResponse = true) {\n    this.setFunctionContext(event, context);\n\n    if (!(await this.isAuthorized())) {\n      return BaseController.httpResponse(\n        401,\n        JSON.stringify({\n          statusCode: 401,\n          message: 'Unauthorized!',\n        }),\n      );\n    }\n\n    try {\n      const response = await this[method](event);\n\n      if (!isHttpResponse) return response;\n\n      const body = typeof response.body === 'string'\n        ? response.body\n        : JSON.stringify(response.body);\n      return BaseController.httpResponse(\n        response.statusCode,\n        body,\n        response.headers,\n      );\n    } catch (err) {\n      const message = err.response && err.response.data\n        ? err.response.data\n        : err.message || err;\n\n      return BaseController.httpResponse(500, message);\n    }\n  }\n\n  setFunctionContext(event, context) {\n    this.event = event;\n    this.context = context;\n\n    process.env.sourceIpAddress = event.requestContext\n      && event.requestContext.identity\n      && event.requestContext.identity.sourceIp\n      ? event.requestContext.identity.sourceIp\n      : null;\n  }\n\n  static httpResponse(statusCode, body, headers = {}) {\n    return {\n      statusCode,\n      body,\n      headers: {\n        'Access-Control-Allow-Origin': '*',\n        'Access-Control-Allow-Headers': '*',\n        ...headers,\n      },\n    };\n  }\n\n  isAuthorized() {\n    const checkByAuthMethod = {\n      header: this.authHeaderIsTheSameInTheEnvironment(),\n    }[this.env.authMethod];\n\n    if (checkByAuthMethod === undefined) {\n      return true;\n    }\n\n    return checkByAuthMethod;\n  }\n\n  authHeaderIsTheSameInTheEnvironment() {\n    return this.event.headers.Authorization === this.env.authToken;\n  }\n\n  /**\n   * @author Victor Hugo Lemos Mattar & Sandrão\n   * @param {*} context\n   * @returns {string}\n   */\n\n  /**\n   * @author Will Saymon & Victor Hugo Lemos Mattar\n   * @param {*} context\n   * @returns {string}\n   */\n}\n","import BaseController from './BaseController';\n\nexport default async (event, context, func, funcName) => {\n  const Controller = class extends BaseController {};\n  const handler = new Controller();\n  handler[funcName] = func;\n  return handler.handle(event, context, funcName);\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"axios\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/taggedTemplateLiteral\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"mssql\");","import sql from 'mssql';\n\nconst connectDB = async () => {\n  const sqlConfig = {\n    user: process.env.DB_USER,\n    password: process.env.DB_PWD,\n    database: process.env.DB_NAME,\n    server: process.env.DB_HOST,\n    port: Number(process.env.DB_PORT),\n    pool: {\n      max: 10,\n      min: 0,\n      idleTimeoutMillis: 30000,\n    },\n    options: {\n      encrypt: true,\n      trustServerCertificate: true,\n    },\n  };\n\n  return sql.connect(sqlConfig);\n};\n\nexport const mssql = {\n  get: async (status) => {\n    try {\n      await connectDB();\n\n      const result = await sql.query`select top 5 * from IGXMLDownload where Status = ${status}`;\n\n      return result?.recordsets?.flat() || [];\n    } catch (error) {\n      console.log(error);\n      return null;\n    }\n  },\n\n  getCert: async (cnpj) => {\n    try {\n      await connectDB();\n\n      const result = await sql.query`select top 1 Senha, RawData from IGCertificadoDigital where CNPJ_Contribuinte = ${cnpj}`;\n\n      return result?.recordsets?.flat() || [];\n    } catch (error) {\n      console.log(error);\n      return null;\n    }\n  },\n\n  update: async (status, nfe) => {\n    try {\n      await connectDB();\n\n      const result = await sql.query`update IGXMLDownload set Status = ${status} where ChaveAcessoDOC = ${nfe}`;\n\n      return result;\n    } catch (error) {\n      console.log(error);\n      return null;\n    }\n  },\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"tough-cookie\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"http-cookie-agent/http\");","import { CookieJar } from 'tough-cookie';\n\nimport { HttpsCookieAgent, HttpCookieAgent } from 'http-cookie-agent/http';\nimport { decrypt } from '../../../../common/cryptography';\n\nimport { mssql } from '../../../../common/mssql';\n\nexport async function getCert(cnpj) {\n  const certDB = await mssql.getCert(cnpj);\n\n  if (!certDB || certDB?.length === 0) {\n    throw new Error(\n      'Não foi localizado nunenhum certificado com esse cnpj: ',\n      cnpj,\n    );\n  }\n\n  const pass = decrypt(certDB[0].Senha);\n\n  const jar = new CookieJar();\n\n  const httpsAgent = new HttpsCookieAgent({\n    cookies: { jar },\n    pfx: certDB[0].RawData,\n    passphrase: pass,\n  });\n\n  const httpAgent = new HttpCookieAgent({\n    cookies: { jar },\n  });\n\n  return { httpsAgent, httpAgent };\n}\n","import axios from 'axios';\n\nimport { mssql } from '../../../../common/mssql';\n\nimport { getCert } from './getCert';\n\nconst addMissingParameterInUrl = (url) => {\n  if (!url.includes('&lp=')) {\n    url\n      += '&lp=L0l4L0hGSE1LMUtGeEJ5elpwTXNYeHRxOEx1RTA2SjhJMkludFZmZ0hvMFJITzBtaEdLK2YvbEFRYXFULzJJTlJyODhQNFVKakNDWTNhWm44NlpwNm9Ddkp2NTdiK3ZhQWFqSTdYQWJzN3M90';\n  }\n\n  return url;\n};\n\nexport async function download({ url, key, cnpj }) {\n  const { httpsAgent, httpAgent } = await getCert(cnpj);\n\n  const instance = axios.create({\n    httpsAgent,\n    httpAgent,\n  });\n\n  url = addMissingParameterInUrl(url);\n\n  try {\n    const xml = await instance({\n      url,\n      method: 'GET',\n      maxRedirects: 1,\n      responseType: 'text/xml',\n    });\n\n    if (!xml.data) {\n      throw new Error('Não foi possível gerar o XML');\n    }\n\n    if (xml.data?.includes('html')) {\n      mssql.update(1, key);\n      throw new Error('Não foi possível gerar o XML');\n    }\n\n    const buffer = Buffer.from(xml.data, 'utf-8');\n\n    return buffer;\n  } catch (error) {\n    console.log(error);\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"form-data\");","import axios from 'axios';\n\nimport FormData from 'form-data';\n\nimport { mssql } from '../../../../common/mssql';\n\nexport async function sendFileToPath(fileBuffer, key) {\n  try {\n    const formData = new FormData();\n\n    formData.append('file', fileBuffer, {\n      filename: `${key}.xml`,\n    });\n\n    const options = {\n      url: `${process.env.BASE_URL_IG}/Arquivo/Upload`,\n      method: 'POST',\n      data: formData,\n      headers: {\n        ...formData.getHeaders(),\n        Authorization: `Bearer ${process.env.AUTH_IG}`,\n      },\n      cache: false,\n    };\n\n    const { data } = await axios(options);\n\n    if (!data?.resultado) {\n      throw new Error('Não foi possível salvar o arquivo na pasta');\n    }\n\n    mssql.update(3, key);\n\n    return data;\n  } catch (error) {\n    console.log(error);\n    mssql.update(1, key);\n    throw new Error(error?.message);\n  }\n}\n","import HttpResponse from '../../../common/httpResponse';\n\nimport { isValidParams } from './validations/validator';\n\nimport handleFunction from '../../../common/handler/handle';\n\nimport { download } from './functions/download';\n\nimport { sendFileToPath } from './functions/sendFileToPath';\n\nexport const downloadXML = async ({ body }) => {\n  try {\n    const params = isValidParams(JSON.parse(body));\n\n    if (params.error) {\n      return HttpResponse.badRequest({\n        message: params.message,\n      });\n    }\n\n    const fileBuffer = await download(params.value);\n\n    if (!fileBuffer) {\n      return HttpResponse.badRequest({\n        message: 'Problemas ao gerar arquivo',\n      });\n    }\n\n    const file = await sendFileToPath(fileBuffer, params.value.key);\n\n    return HttpResponse.ok(file);\n  } catch (error) {\n    console.log(error);\n    return HttpResponse.serverError({\n      error: error?.message,\n      message: 'Ocorreu um erro ao gerar o arquivo',\n    });\n  }\n};\n\nexport const handle = async (event, context) => handleFunction(event, context, downloadXML, 'downloadXML');\n","import { schema } from './schema';\r\n\r\nexport function isValidParams(params) {\r\n  if (!params) {\r\n    return {\r\n      error: true,\r\n      message: 'Faltando parâmetros obrigatórios',\r\n    };\r\n  }\r\n\r\n  const result = schema.validate(params);\r\n  if (result.error) {\r\n    return {\r\n      error: true,\r\n      message: `O seguinte parâmetro está faltando ou incorreto: ${result.error.details[0].path[0]}`,\r\n    };\r\n  }\r\n\r\n  return {\r\n    value: result.value,\r\n    error: false,\r\n  };\r\n}\r\n"],"names":["module","exports","codes","reverseCodes","$","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","ƒ","ˆ","Š","Œ","Ž","š","œ","ž","Ÿ","ª","µ","º","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","ø","ù","ú","û","ü","ý","þ","ÿ","require","criptoRule","strCripto","cypher","arguments","length","undefined","valorFinal","aChaves","split","forEach","el","encrypt","decrypt","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","key","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","HttpResponse","static","body","statusCode","schema","Joi","url","required","cnpj","BaseController","constructor","event","context","env","process","handle","method","_arguments","_this","_asyncToGenerator","isHttpResponse","setFunctionContext","isAuthorized","httpResponse","JSON","stringify","message","response","headers","err","data","this","sourceIpAddress","requestContext","identity","sourceIp","_objectSpread","checkByAuthMethod","header","authHeaderIsTheSameInTheEnvironment","authMethod","Authorization","authToken","_ref","func","funcName","handler","_x","_x2","_x3","_x4","apply","_update","_get","connectDB","sqlConfig","user","DB_USER","password","DB_PWD","database","DB_NAME","server","DB_HOST","port","Number","DB_PORT","pool","max","min","idleTimeoutMillis","options","trustServerCertificate","sql","mssql","status","_result$recordsets","result","_templateObject","_taggedTemplateLiteral","recordsets","flat","error","console","log","getCert","_getCert","_result$recordsets2","_templateObject2","update","nfe","_templateObject3","certDB","Error","pass","Senha","jar","CookieJar","httpsAgent","HttpsCookieAgent","cookies","pfx","RawData","passphrase","httpAgent","HttpCookieAgent","_download","instance","axios","includes","addMissingParameterInUrl","_xml$data","xml","maxRedirects","responseType","Buffer","from","_sendFileToPath","fileBuffer","formData","FormData","append","filename","concat","BASE_URL_IG","getHeaders","AUTH_IG","cache","resultado","downloadXML","_ref2","params","validate","details","path","isValidParams","parse","badRequest","download","file","sendFileToPath","ok","serverError","_ref3","handleFunction"],"sourceRoot":""}